# 캐시란?

데이터베이스는 SQL문을 빠르게 처리하기 위한 많은 방법을 사용합니다.

그중에서도 데이터베이스의 처리속도에 가장 큰 영향을 미치는 것은 디스크 I/O 동작입니다.그래서 데이터베이스는 '캐시'라고 불리는 기술을 사용해 가능한 디스크에서 처리하지 않고, 메모리에서 처리하는 구조를 갖고 있습니다.

빈번하게 사용하는 데이터를 매번 디스크에서 꺼내오지 않고 캐시라고 불리는 메모리에 두고 꺼내오므로써 디스크 I/O하는 동작을 생략해 처리속도를 올리는 것입니다.

오라클에서의 데이터 캐시는 '버퍼 캐시'라고 불립니다.

오라클에서 버퍼 캐시의 존재 유무에 따라 동작이 어떻게 다른지 한번 살펴보겠습니다.

<그림3.4>

<버퍼 캐시에 데이터가 존재할 때>

<그림3.5>

<버퍼 캐시에 데이터가 존재하지 않을 때>

캐시는 데이터 뿐만 아니라 인덱스도 캐시할 수 있습니다.

여기서 인덱스를 3계층이라고 가정하고 인덱스를 사용해 테이블에서 데이터를 한건만 꺼내오는 SQL문에 걸리는 시간을 예측해보겠습니다.

<br>

![image3](/Img/DB/disk2.png)

'빌'이라는 데이터를 찾는 과정을 살펴보겠습니다.

I/O 한번 당 10밀리초, SQL 처리에 1밀리초가 걸린다고 가정해보겠습니다.

<br>

### 캐시를 사용하지 않을때

1. `'빌'`이라는 데이터가 버퍼 캐시에 없으니 디스크에서 읽어 와야합니다.
2. 인덱스를 통해 **32번 주소**를 읽어라는 것을 알 수 있습니다. (+10밀리초)
3. 32번 주소에 대한 데이터가 버퍼 캐시에 없으므로 디스크에서 읽어 와야합니다.
4. 32번 주소를 통해 **151번 주소**를 읽어라는 것을 알 수 있습니다. (+ 10밀리초)
5. 151번 주소에 대한 데이터가 버퍼 캐시에 없으므로 디스크에서 읽어 와야합니다.
6. 151번 주소를 통해 **501번 주소**를 읽어야 하는 것을 알 수 있습니다. (+10밀리초)
7. 501번 주소에 대한 데이터가 버퍼 캐시에 없으므로 디스크에서 읽어 와야합니다.
8. 501번 주소 데이터가 `'빌'`이므로 '빌'이라는 데이터를 읽어 옵니다.(+10밀리초)

<br>

인덱스를 사용하더라고 '빌'이라는 데이터를 읽어오기 위해 디스크 I/O 동작이 총 4번 반복되어야 하고 그로인해 총 처리 시간은 **40밀리초 + 1밀리초 = 41밀리초**가 소요되게 됩니다.

하지만 캐시에 '빌'이라는 데이터가 있다면 처리시간은 **1 밀리초**로 줄어들게 됩니다.

캐시를 사용했을의 효과와 왜 캐시를 사용해야 하는지를 이해 할 수 있을 것이라고 생각합니다.

<br><br>

